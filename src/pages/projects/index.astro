---
import MainLayout from "../../layouts/MainLayout.astro";

// Get all project posts
const allProjects = await Astro.glob('./*.md');
const sortedProjects = allProjects.sort(
  (a, b) => new Date(b.frontmatter.pubDate).valueOf() - new Date(a.frontmatter.pubDate).valueOf()
);
---

<MainLayout>
  <div class="min-h-screen px-6 sm:px-8 py-20 sm:py-24 lg:py-32 md:px-20 relative z-20 flex flex-col items-center">
    <div class="w-full max-w-4xl">
      <h1 class="text-slate-200 text-4xl sm:text-5xl md:text-6xl !mb-12 font-semibold">
        My Projects
      </h1>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-8">
        {sortedProjects.map((project) => {
          const filePath = project.file || '';
          const slug = filePath.split('/').pop()?.split('.').shift() || '';

          return (
            <div class="border border-slate-700/60 rounded-xl p-6 flex flex-col gap-4 hover:border-slate-500/70 transition duration-200">
              <h2 class="text-slate-200 text-xl sm:text-2xl">
                <a href={`/projects/${slug}`} class="hover:text-indigo-400 transition duration-200">
                  {project.frontmatter.title}
                </a>
              </h2>
              <p class="text-slate-400 text-sm flex-1">
                {project.frontmatter.description}
              </p>
              <div class="flex flex-wrap gap-2">
                {(project.frontmatter.tags || []).map((tag: string) => (
                  <span class="px-3 py-1 text-xs rounded-full bg-slate-800 text-slate-300">
                    {tag}
                  </span>
                ))}
              </div>
              <a
                href={`/projects/${slug}`}
                class="text-slate-400 hover:text-indigo-400 underline underline-offset-2 duration-200 text-sm"
              >
                View project details â†’
              </a>
            </div>
          );
        })}
      </div>
    </div>
  </div>
</MainLayout>
